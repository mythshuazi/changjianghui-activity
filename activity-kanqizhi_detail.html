<!DOCTYPE html>
<html style="height:100%;">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>主要看气质</title>
<meta name="description" content="">
<meta name="keywords" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<meta name="format-detection" content="telephone=no" />
<meta http-equiv="Expires" content="-1">
<meta http-equiv="Cache-Control" content="no-cache">
<meta http-equiv="Pragma" content="no-cache">
<link rel="stylesheet" href="stylesheets/public.css">
<link rel="stylesheet" href="stylesheets/activity.css">
<script src="javascripts/plugin/zepto.js"></script>
<script src="javascripts/plugin/scrollLoading.js"></script>
<script type="text/javascript">
    $('html').css({
        fontSize: $(window).width()/10
    });
    $(window).resize(function(){
        $('html').css({
            fontSize: $(window).width()/10
        });
    });
</script>
</head>
<body class="kqz_body" style="height:100%;">
    <div class="mainContainer" style="height:100%; overflow:scroll;">
        <div class="mainContent">        	
        	<section id="top">
        		<div class="content">
                    <img class="scrollLoad" data-url="images/kanqizhi/kqz_01.png" width="100%" onerror="this.src=''">
                    <img class="scrollLoad" data-url="images/kanqizhi/kqz_02.png" width="100%" onerror="this.src=''">
                    <img class="scrollLoad" data-url="images/kanqizhi/kqz_03.png" width="100%" onerror="this.src=''">
        		</div>

                <div id="search" class="clear">
                    <input type="number" placeholder="输入您要投票的编号">
                    <a class="sure"></a>
                </div>
        	</section>

        	<section id="list">
                <input type="hidden" id="attention" value="1">
        		<ul class="portrait manjian">
        			<li id="search_1" class="pt_item" data-id="1">
        				<div class="pt_item_inner">
        					<div class="pt_above">
        						<img class="pt_pic scrollLoad" data-url="images/activity/xiaolongren.png" width="100%" onerror="this.src=''">
                                <!-- <div class="pt_nothing"><i>抢光了</i></div> -->
        					</div>
        					<div class="pt_middle">
        						<p class="pt_intro">张三张三张三张三张三</p>
        						<div class="price"><i>票数：</i>1306587</div>
        						<span class="vote">投 票</span>
        					</div>
        					<!-- <div class="pt_bottom">
        					</div> -->
        					<div class="pt_prefix">01</div>
        				</div>
        			</li>
        			<li id="search_02" class="pt_item" data-id="2">
        				<div class="pt_item_inner">
        					<div class="pt_above">
        						<img class="pt_pic scrollLoad" data-url="images/activity/xiaolongren.png" width="100%" onerror="this.src=''">
                                <!-- <div class="pt_nothing"><i>抢光了</i></div> -->
        					</div>
        					<div class="pt_middle">
        						<p class="pt_intro">李思思李思思李思思李思思李思思</p>
        						<div class="price"><i>票数：</i>1306587</div>
        						<span class="vote">投 票</span>
        					</div>
        					<!-- <div class="pt_bottom">
        					</div> -->
        					<div class="pt_prefix">02</div>
        				</div>
        			</li>
        			<li id="search_3" class="pt_item" data-id="3">
        				<div class="pt_item_inner">
        					<div class="pt_above">
        						<img class="pt_pic scrollLoad" data-url="images/activity/xiaolongren.png" width="100%" onerror="this.src=''">
                                <!-- <div class="pt_nothing"><i>抢光了</i></div> -->
        					</div>
        					<div class="pt_middle">
        						<p class="pt_intro">李思思李思思李思思李思思李思思</p>
        						<div class="price"><i>票数：</i>1306587</div>
        						<span class="vote">投 票</span>
        					</div>
        					<!-- <div class="pt_bottom">
        					</div> -->
        					<div class="pt_prefix">03</div>
        				</div>
        			</li>
                    <li id="search_4" class="pt_item" data-id="4">
                        <div class="pt_item_inner">
                            <div class="pt_above">
                                <img class="pt_pic scrollLoad" data-url="images/activity/xiaolongren.png" width="100%" onerror="this.src=''">
                                <!-- <div class="pt_nothing"><i>抢光了</i></div> -->
                            </div>
                            <div class="pt_middle">
                                <p class="pt_intro">李思思</p>
                                <div class="price"><i>票数：</i>1306587</div>
                                <span class="vote">投 票</span>
                            </div>
                            <!-- <div class="pt_bottom">
                            </div> -->
                            <div class="pt_prefix">04</div>
                        </div>
                    </li>
                    <li id="search_5" class="pt_item" data-id="5">
                        <div class="pt_item_inner">
                            <div class="pt_above">
                                <img class="pt_pic scrollLoad" data-url="images/activity/gift_01.jpg" width="100%" onerror="this.src=''">
                                <!-- <div class="pt_nothing"><i>抢光了</i></div> -->
                            </div>
                            <div class="pt_middle">
                                <p class="pt_intro">哈哈哈</p>
                                <div class="price"><i>票数：</i>1306587</div>
                                <span class="vote">投 票</span>
                            </div>
                            <!-- <div class="pt_bottom">
                            </div> -->
                            <div class="pt_prefix">05</div>
                        </div>
                    </li>
        		</ul>
                <!-- <div class="more">查看更多<span> >></span>  </div> -->
        	</section>
        </div>
        <div class="gameOver">
            <p>您来晚啦，</p>
            <p>活动结束了~</p>
            <div>评比结果将于长江汇APP揭晓</div>
            <img src="images/kanqizhi/gameOver_01.jpg" width="100%" >
            <img src="images/kanqizhi/gameOver_02.jpg" width="100%" >
            <img src="images/kanqizhi/gameOver_03.jpg" width="100%" >
            <div>
                <a href="">下载长江汇APP</a>
            </div>
        </div>
    </div>
    <div class="attention">
        <div class="wrap">
            <div class="container">
                <img class="title" src="images/kanqizhi/attention_01.jpg" width="100%">
                <img class="qrcode" src="images/kanqizhi/attention_02.jpg" width="100%">
                <p>长按图片识别二维码</p>
                <p>关注即可投票喽~</p>
            </div>            
        </div>
    </div>
    <div id="loading">
        <img src="images/kanqizhi/loading.gif"  width="15%" >
    </div>
</body>
<script type="text/javascript">
$(function(){
    var container = $('.mainContainer'),
        winH      = container.height();

    //返回顶部
    container.on('scroll',function(){
        if(container.scrollTop() > winH/2 && $('#toTop').length<=0){
            $('body').append('<div id="toTop" style="width:1.5rem;height:1.5rem;background-image:url(\'images/public/arrow_up.png\');background-repeat:no-repeat;background-size:100%;position:absolute; bottom:10px; right:10px;"></div>')

            $('#toTop').on('tap',function(){
                container.scrollTop(0);
                $(this).hide();
            });

        }else{
            $('#toTop').show();
        }

        if(container.scrollTop() < winH/2){
            $('#toTop').hide();
        }

    });


    //搜索
    $(document).on('tap','.sure',function(){
        var input = $(this).siblings('input'),
            val   = parseInt(input.val()),
            top   = $('#search_' + val).length>0 ? $('#search_' + val).offset().top : null;

            if(top){
                container.scrollTop(top);
                input.val('');
            }else{
                pop(0,'该编号不存在');
            }
    });
    
	//图片滚动加载
    $('.scrollLoad').scrollLoading({container:$('.mainContainer')});

    //隐藏关注弹窗
    $(document).on('tap', '.attention', function(e){
        if($(e.target).hasClass('attention')){
            attentionHide();
        }
    });

    $(document).on('tap','.vote',function(){
        loadingShow()
        var isSucceed = $(this).closest('li').data('succeed'),
            text      = (isSucceed == 1) ? '成功' : '失败';
        
    	pop(isSucceed,text);

    });


});
    

    

function pop(isSuccessed, text, callback){
	var mapClass = (function(){
            switch (isSuccessed){
                case -1:
                    return 'notStart';
                case 1 :
                    return 'successed';
                default :
                    return 'failed';
            }
        })(),
        mapTxt  = text ? text : 'sorry',
		winH = $('body').height(),
		popH;

		// $('.pop span').off('tap');
		// $('.pop').off('tap');
		// $('.pop').remove();

        if( $('.pop').length > 0 ){
            var pop = $('.pop');
            pop[0].className = 'pop';
            pop.addClass(mapClass).show();
            pop.find('.txt').html(text);
        }else{

            var html = '<div class="pop '+ mapClass +'">'+
                           '<div class="inner">'+
                               '<div class="title"><span class="close">×</span></div>'+
                               '<div class="img"></div>'+
                               '<p class="txt">'+ mapTxt +'</p>'+
                           '</div>'+
                       '</div>';
            $(html).appendTo('body');

            //隐藏弹窗
            $('.close').on('tap',function(){
                $(this).closest('.pop').hide();
            });

            $('.pop').on('tap',function(e){
                if( $(e.target).hasClass('pop') ){
                    $(this).hide();
                }
            })
        }

            //弹窗显示的位置
            popH = $('.pop .inner').height();
            $('.pop').css('paddingTop',(winH-popH)/2-40);

        callback && $.isFunction(callback) && callback();
}
attentionShow()
function attentionShow(){
    var atn  = $('.attention'),
        wrap = atn.find('.wrap'),
        winH = $('body').height(),
        atnH;

        atn.show();
        wrap.css('marginTop', (winH-(wrap.height()))/2 );
}

function attentionHide(){
    $('.attention').hide();
}

function loadingShow(){
    var load = $('#loading'),
        img  = load.find('img'),
        winH = $('body').height();

    load.show();
    img.css('marginTop', (winH-(img.height()))/2);
}
function loadingHide(){
    var load = $('#loading');
    load.hid();
}


</script>
</html>